webpackJsonp([9],{27:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=e(4);e.n(n);$(document).ready(function(){var a=$("#example").DataTable();$("#min, #max").keyup(function(){a.draw()})});var r,o=$("#historial-ventas-table").DataTable({responsive:{},columns:[{data:"id_venta"},{data:"estado"},{data:"nombre_cliente"},{data:"descripcion"},{data:"retraso"},{data:"detalles"},{data:"precio",render:$.fn.dataTable.render.number(",",".",2,"$"),type:"num-fmt"},{data:"comision",render:$.fn.dataTable.render.number(",",".",2,"$"),type:"num-fmt"},{data:"pagado",render:$.fn.dataTable.render.number(",",".",2,"$"),type:"num-fmt"},{data:"comisionado",render:$.fn.dataTable.render.number(",",".",2,"$"),type:"num-fmt"},{data:"nombre_lider"},{data:"nombre_user"},{data:"",render:function(a,t,r,o){if(null!=r.estado&&void 0!=r.estado&&""!=r.estado&&null!=r.version&&void 0!=r.version&&""!=r.version){console.log("Render data"),console.log(r.estado),console.log(r.version);var s='<a href="'+e.i(n.base_url)()+"reportes/contrato/"+r.id_venta+'" class="btn btn-default" target="_blank"><i class="fa fa-file-pdf-o" aria-hidden="true"></i> contrato</a>',i='<a href="'+e.i(n.base_url)()+"reportes/"+(2==r.version?"pagares":"recibos")+"/"+r.id_venta+'" class="btn btn-primary" target="_blank"><i class="fa fa-file-pdf-o" aria-hidden="true"></i> '+(2==r.version?"pagares":"recibos")+"</a>",l='<a href="'+e.i(n.base_url)()+"registros/pagos/"+r.id_venta+'" target="_blank" class="btn btn-info"><i class="fa fa-fw fa-eye"></i>pagos</a>',c="",d="",u="",p="";return 0==r.estado?(c='<button title="Cancelar Contrato" class="btn btn-warning cancelar-venta"><span class="fa fa-ban fa-lg"></span> Cancelar</button>',u='<button title="Eliminar Contrato" class="btn btn-danger eliminar-venta"><span class="fa fa-trash fa-lg"></span> Eliminar</button>'):2==r.estado?(d='<button class="btn btn-success activar-venta"> <span class="fa fa-check"></span>Restablecer</button>',u='<button title="Eliminar Contrato" class="btn btn-danger eliminar-venta"><span class="fa fa-trash fa-lg"></span> Eliminar</button>'):3==r.estado&&(p='<button class="btn recuperar-venta"> <span class="fa fa-undo"></span> Recuperar</button>',s="",i="",l=""),s+" "+i+" "+l+" "+c+" "+d+" "+u+" "+p}return console.log("Return data"),a}}],columnDefs:[{targets:-1,data:null,defaultContent:""},{targets:[],searchable:!1}],order:[[3,"asc"]]});$("#historial-ventas-table").on("click",".cancelar-venta",function(){r=$(this).closest("tr").hasClass("child")?$(this).closest("tr").prev("tr.parent"):$(this).parents("tr");var a=o.row(r).data(),t={id_venta:a.id_venta};swal({title:"Cancelar venta",text:"Esta a punto de cancelar una venta, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){$.ajax({url:e.i(n.base_url)()+"ajax/cancelar_venta/",data:t,type:"post"}).done(function(a){var t=o.row(r).data(a).draw(!1).node();$(t).css({backgroundColor:"yellow"}),swal("Confirmación","¡Venta cancelada!","success")}).fail(function(a){swal("Error:","¡Ha ocurrido un error, contactar al administrador sí el problema persiste!","error")})})}),$("#historial-ventas-table").on("click",".activar-venta",function(){r=$(this).closest("tr").hasClass("parent")||$(this).closest("tr").hasClass("child")?$(this).closest("tr").prev("tr.parent"):$(this).parents("tr");var a=o.row(r).data(),t={id_venta:a.id_venta};swal({title:"Restablecer venta",text:"Esta a punto de restablecer una venta, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){$.ajax({url:e.i(n.base_url)()+"ajax/activar_venta/",data:t,type:"post"}).done(function(a){if(200==a.status){var t=o.row(r).data(a).draw(!1).node();$(t).animate({backgroundColor:"yellow"}),swal("Confirmación","¡Venta restablecida!","success")}else swal("Error:","¡Ha ocurrido un error, contactar al administrador sí el problema persiste! \n"+a.msg_status,"error")}).fail(function(a){swal("Error:","¡Ha ocurrido un error, contactar al administrador sí el problema persiste! ","error")})})}),$("#historial-ventas-table").on("click",".eliminar-venta",function(){r=$(this).closest("tr").hasClass("child")?$(this).closest("tr").prev("tr.parent"):$(this).parents("tr");var a=o.row(r).data(),t={id_venta:a.id_venta};swal({title:"Eliminar venta",text:"Esta a punto de eliminar una venta, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){$.ajax({url:e.i(n.base_url)()+"ajax/eliminar_venta/",data:t,type:"post"}).done(function(a){var t=o.row(r).data(a).draw(!1).node();$(t).css({backgroundColor:"yellow"}),swal("Confirmación","¡Venta eliminada!","success")}).fail(function(a){swal("Error:","¡Ha ocurrido un error, contactar al administrador sí el problema persiste!","error")})})}),$("#historial-ventas-table").on("click",".recuperar-venta",function(){r=$(this).closest("tr").hasClass("child")?$(this).closest("tr").prev("tr.parent"):$(this).parents("tr");var a=o.row(r).data(),t={id_venta:a.id_venta};swal({title:"Recuperar venta",text:"Esta a punto de recuperar una venta, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){$.ajax({url:e.i(n.base_url)()+"ajax/recuperar_venta/",data:t,type:"post"}).done(function(a){var t=o.row(r).data(a).draw(!1).node();$(t).animate({backgroundColor:"yellow"}),swal("Confirmación","¡Venta recuperada!","success")}).fail(function(a){swal("Error:","¡Ha ocurrido un error, contactar al administrador sí el problema persiste!","error")})})}),$("a[data-toggle=popover]").popover({html:!0,trigger:"manual"}),$("a[data-toggle=popover]").on("click",function(a){$(this).popover("toggle"),$(".popover").on("click",function(a){a.stopPropagation()}),a.stopPropagation()}),$("a[data-toggle=popover]").on("shown.bs.popover",function(a){console.log("show"+this),$("a[data-toggle=popover]").not(this).popover("hide")}),$("#email-notificator").on("click",function(a){var t=this;$(t).next().css("visibility","visible"),$.ajax({url:e.i(n.base_url)()+"mail/",type:"get",async:!0}).done(function(a){$(t).attr("disabled",!1).next().css("visibility","hidden"),swa("finalizado")}).fail(function(a){$(t).attr("disabled",!1).next().css("visibility","hidden")})}),$(".estado-venta").on("change",function(){o.draw()})}});