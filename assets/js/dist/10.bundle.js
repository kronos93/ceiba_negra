webpackJsonp([10],{273:function(a,t,e){"use strict";var n=e(25);e(182);var r=e(185),o=function(a){return a&&a.__esModule?a:{default:a}}(r);$(document).ready(function(){var a=$("#example").DataTable();$("#min, #max").keyup(function(){a.draw()})}),$.fn.dataTable.ext.search.push(function(a,t,e){var n=$(".estado-venta:checked").val(),r=t[1];if(void 0==n||""==n||null==n||"all"==n){if(0==r||1==r||2==r||3==r)return!0}else if(r==n)return!0;return!1});var s,i=$("#historial-ventas-table").DataTable({responsive:{},columns:[{data:"id_venta"},{data:"estado"},{data:"nombre_cliente"},{data:"descripcion"},{data:"retraso",type:"num"},{data:"detalles"},{data:"precio",render:$.fn.dataTable.render.number(",",".",2,"$"),type:"num-fmt"},{data:"comision",render:$.fn.dataTable.render.number(",",".",2,"$"),type:"num-fmt"},{data:"pagado",render:$.fn.dataTable.render.number(",",".",2,"$"),type:"num-fmt"},{data:"comisionado",render:$.fn.dataTable.render.number(",",".",2,"$"),type:"num-fmt"},{data:"nombre_lider"},{data:"nombre_user"},{data:"",render:function(a,t,e,r){if(null!=e.estado&&void 0!=e.estado&&""!=e.estado&&null!=e.version&&void 0!=e.version&&""!=e.version){var o='<a href="'+(0,n.base_url)()+"reportes/contrato/"+e.id_venta+'" class="btn btn-default" target="_blank"><i class="fa fa-file-pdf-o" aria-hidden="true"></i> contrato</a>',s='<a href="'+(0,n.base_url)()+"reportes/"+(2==e.version?"pagares":"recibos")+"/"+e.id_venta+'" class="btn btn-primary" target="_blank"><i class="fa fa-file-pdf-o" aria-hidden="true"></i> '+(2==e.version?"pagares":"recibos")+"</a>",i='<a href="'+(0,n.base_url)()+"registros/pagos/"+e.id_venta+'" target="_blank" class="btn btn-info"><i class="fa fa-fw fa-eye"></i>pagos</a>',l='<a href="'+(0,n.base_url)()+"registros/pagos/"+e.id_venta+'" target="_blank" class="btn btn-info">Estado de cta.</a>',c="",d="",u="",f="";return 0==e.estado?(c='<button title="Cancelar Contrato" class="btn btn-warning cancelar-venta"><span class="fa fa-ban fa-lg"></span> Cancelar</button>',u='<button title="Eliminar Contrato" class="btn btn-danger eliminar-venta"><span class="fa fa-trash fa-lg"></span> Eliminar</button>'):2==e.estado?(d='<button class="btn btn-success activar-venta"> <span class="fa fa-check"></span>Restablecer</button>',u='<button title="Eliminar Contrato" class="btn btn-danger eliminar-venta"><span class="fa fa-trash fa-lg"></span> Eliminar</button>'):3==e.estado&&(f='<button class="btn recuperar-venta"> <span class="fa fa-undo"></span> Recuperar</button>',o="",s="",i=""),o+" "+l+" "+s+" "+i+" "+c+" "+d+" "+u+" "+f}return a}}],columnDefs:[{targets:-1,data:null,defaultContent:""},{targets:[],searchable:!1}],order:[[3,"asc"]]});$("#historial-ventas-table").on("click",".cancelar-venta",function(){s=$(this).closest("tr").hasClass("child")?$(this).closest("tr").prev("tr.parent"):$(this).parents("tr");var a=i.row(s).data(),t={id_venta:a.id_venta};(0,o.default)({title:"Cancelar venta",text:"Esta a punto de cancelar una venta, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){$.ajax({url:(0,n.base_url)()+"ajax/cancelar_venta/",data:t,type:"post"}).done(function(a){var t=i.row(s).data(a).draw(!1).node();$(t).css({backgroundColor:"yellow"}),(0,o.default)("Confirmación","¡Venta cancelada!","success")}).fail(function(a){(0,o.default)("Error:","¡Ha ocurrido un error, contactar al administrador sí el problema persiste!","error")})})}),$("#historial-ventas-table").on("click",".activar-venta",function(){s=$(this).closest("tr").hasClass("parent")||$(this).closest("tr").hasClass("child")?$(this).closest("tr").prev("tr.parent"):$(this).parents("tr");var a=i.row(s).data(),t={id_venta:a.id_venta};(0,o.default)({title:"Restablecer venta",text:"Esta a punto de restablecer una venta, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){$.ajax({url:(0,n.base_url)()+"ajax/activar_venta/",data:t,type:"post"}).done(function(a){if(200==a.status){var t=i.row(s).data(a).draw(!1).node();$(t).animate({backgroundColor:"yellow"}),(0,o.default)("Confirmación","¡Venta restablecida!","success")}else(0,o.default)("Error:","¡Ha ocurrido un error, contactar al administrador sí el problema persiste! \n"+a.msg_status,"error")}).fail(function(a){(0,o.default)("Error:","¡Ha ocurrido un error, contactar al administrador sí el problema persiste! ","error")})})}),$("#historial-ventas-table").on("click",".eliminar-venta",function(){s=$(this).closest("tr").hasClass("child")?$(this).closest("tr").prev("tr.parent"):$(this).parents("tr");var a=i.row(s).data(),t={id_venta:a.id_venta};(0,o.default)({title:"Eliminar venta",text:"Esta a punto de eliminar una venta, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){$.ajax({url:(0,n.base_url)()+"ajax/eliminar_venta/",data:t,type:"post"}).done(function(a){var t=i.row(s).data(a).draw(!1).node();$(t).css({backgroundColor:"yellow"}),(0,o.default)("Confirmación","¡Venta eliminada!","success")}).fail(function(a){(0,o.default)("Error:","¡Ha ocurrido un error, contactar al administrador sí el problema persiste!","error")})})}),$("#historial-ventas-table").on("click",".recuperar-venta",function(){s=$(this).closest("tr").hasClass("child")?$(this).closest("tr").prev("tr.parent"):$(this).parents("tr");var a=i.row(s).data(),t={id_venta:a.id_venta};(0,o.default)({title:"Recuperar venta",text:"Esta a punto de recuperar una venta, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){$.ajax({url:(0,n.base_url)()+"ajax/recuperar_venta/",data:t,type:"post"}).done(function(a){var t=i.row(s).data(a).draw(!1).node();$(t).animate({backgroundColor:"yellow"}),(0,o.default)("Confirmación","¡Venta recuperada!","success")}).fail(function(a){(0,o.default)("Error:","¡Ha ocurrido un error, contactar al administrador sí el problema persiste!","error")})})}),$("a[data-toggle=popover]").popover({html:!0,trigger:"manual"}),$("a[data-toggle=popover]").on("click",function(a){$(this).popover("toggle"),$(".popover").on("click",function(a){a.stopPropagation()}),a.stopPropagation()}),$("a[data-toggle=popover]").on("shown.bs.popover",function(a){console.log("show"+this),$("a[data-toggle=popover]").not(this).popover("hide")}),$("#email-notificator").on("click",function(a){var t=this;$(t).next().css("visibility","visible"),$.ajax({url:(0,n.base_url)()+"mail/",type:"get",async:!0}).done(function(a){$(t).attr("disabled",!1).next().css("visibility","hidden"),swa("finalizado")}).fail(function(a){$(t).attr("disabled",!1).next().css("visibility","hidden")})}),$(".estado-venta").on("change",function(){console.log("redibujar"),i.draw()})}});