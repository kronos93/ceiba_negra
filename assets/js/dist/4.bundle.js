webpackJsonp([4,13],{268:function(e,a,t){"use strict";function r(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var o=function(){function e(e,a){for(var t=0;t<a.length;t++){var r=a[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(a,t,r){return t&&e(a.prototype,t),r&&e(a,r),a}}(),n=t(25),l=t(35),i=function(){function e(){r(this,e);$("#shopCartSale").off("click").on("click",function(e){$(this).find(".my-dropdown").slideToggle("3500")}),$("#shopCartSale").find("nav").off("click").on("click",function(e){e.stopPropagation()}),$(document).off("mouseup").on("mouseup",function(e){var a=$(".my-dropdown");a.is(e.target)||0!==a.has(e.target).length||a.hide()})}return o(e,[{key:"get",value:function(){var e=this;$.get((0,n.base_url)()+"ajax/add_cart",function(a){e.templateCart(a)})}},{key:"delete",value:function(e){var a=this;$.ajax({url:(0,n.base_url)()+"ajax/delete_cart/",data:{rowid:e},type:"post"}).done(function(e){a.templateCart(e)}).fail(function(e){})}},{key:"templateCart",value:function(e){var a=this;$("#shopCartSale").find("span").attr("data-venta",e.count);var t=document.getElementById("template-venta").innerHTML,r=Mustache.render(t,e);if(document.getElementById("listaVenta").innerHTML=r,(0,l.format_numeric)("init"),localStorage.setItem("precio",e.total),localStorage.setItem("enganche",e.enganche),localStorage.setItem("abono",e.abono),e.is_reserva?(localStorage.setItem("id_reserva",e.id_reserva),localStorage.setItem("id_lider",e.id_lider),localStorage.setItem("nombre_lider",e.nombre_lider),localStorage.setItem("nombre_cliente",e.nombre_cliente),localStorage.setItem("apellidos_cliente",e.apellidos_cliente),localStorage.setItem("email_cliente",e.email_cliente),localStorage.setItem("phone_cliente",e.phone_cliente),localStorage.setItem("comment",e.comment),localStorage.setItem("is_reserva",!0)):(localStorage.removeItem("id_reserva"),localStorage.removeItem("id_lider"),localStorage.removeItem("nombre_lider"),localStorage.removeItem("nombre_cliente"),localStorage.removeItem("apellidos_cliente"),localStorage.removeItem("email_cliente"),localStorage.removeItem("phone_cliente"),localStorage.removeItem("comment"),localStorage.setItem("is_reserva",!1)),$("#frm-venta #precio").length&&$("#frm-venta #enganche").length&&$("#frm-venta #abono").length&&$("#comision").length){$("#frm-venta #precio").autoNumeric("set",localStorage.getItem("precio")),$("#frm-venta #enganche").autoNumeric("set",localStorage.getItem("enganche")),$("#frm-venta #abono").autoNumeric("set",localStorage.getItem("abono"));var o=$("#porcentaje_comision").val();$("#frm-venta #comision").autoNumeric("set",o/100*$("#precio").autoNumeric("get")),e.is_reserva?($("#first_name").val(localStorage.getItem("nombre_cliente")),$("#last_name").val(localStorage.getItem("apellidos_cliente")),$("#id_lider").val(localStorage.getItem("id_lider")),$("#lideres_autocomplete").val(localStorage.getItem("nombre_lider")),$("#email").val(localStorage.getItem("email_cliente")),$("#phone").val(localStorage.getItem("phone_cliente")),localStorage.getItem("comment")?$("#comments").show().html(localStorage.getItem("comment")):$("#comments").hide().html(""),$("#id_reserva").val(localStorage.getItem("id_reserva"))):($("#first_name").val(""),$("#last_name").val(""),$("#id_lider").val(""),$("#lideres_autocomplete").val(""),$("#email").val(""),$("#phone").val(""),$("#comments").hide().empty(),$("#id_reserva").val(""))}else $("#frm-reserva #precio").length&&$("#frm-reserva #enganche").length&&$("#frm-reserva #abono").length&&($("#frm-reserva #precio").autoNumeric("set",localStorage.getItem("precio")),$("#frm-reserva #enganche").autoNumeric("set",localStorage.getItem("enganche")),$("#frm-reserva #abono").autoNumeric("set",localStorage.getItem("abono")));if(!e.count){var i=window.location.pathname,c=i.split("/"),s=c[c.length-1];"venta"!=s&&"reserva"!=s||(window.location.href=(0,n.base_url)())}$(".itemCartDelete").off("click").on("click",function(e){var t=$(this).val();a.delete(t),e.stopPropagation()})}}]),e}();a.default=i},278:function(e,a,t){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t(182),t(185);var o,n=t(25),l=t(183),i=(r(l),t(268)),c=r(i),s=new c.default,m=$("#reservas-table").DataTable({ajax:(0,n.base_url)()+"ajax/get_reservas",columns:[{data:"id_reserva"},{data:"nombre_lider"},{data:"descripcion"},{data:"detalles"},{data:"expira",render:$.fn.dataTable.render.moment("DD-MM-YYYY")},{data:"",render:function(e,a,t,r){var o='<button class="btn btn-danger cancelar-reserva">Eliminar</button>';return 1==t.is_admin?o+' <button class="btn btn-primary aplicar-reserva">Aplicar</button>':o}}],columnDefs:[{targets:-1,data:null,defaultContent:""},{sortable:!1,targets:[-1,3]}]});$("#reservas-table").on("click",".cancelar-reserva",function(){o=$(this).closest("tr").hasClass("child")?$(this).closest("tr").prev("tr.parent"):$(this).parents("tr");var e=m.row(o).data(),a={id_reserva:e.id_reserva};swal({title:"Eliminar reserva",text:"Esta a punto de eliminar una reserva, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){$.ajax({url:(0,n.base_url)()+"reserva/eliminar",data:a,type:"post"}).done(function(e){m.row(o).remove().draw();var a=$("#reservas-badge").html();$("#reservas-badge").html(a-1),swal("Hechó","¡Reserva eliminada!","success")}).fail(function(e){swal("¡Error!","La operación que intentó realizar ha fallado, contactar al administador sí el error persiste","error")})})}),$("#reservas-table").on("click",".aplicar-reserva",function(){o=$(this).closest("tr").hasClass("child")?$(this).closest("tr").prev("tr.parent"):$(this).parents("tr");var e=m.row(o).data(),a={id_reserva:e.id_reserva};swal({title:"Aplicar reserva",text:"Esta a punto de aplicar una reserva, se limpiará el carrito ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){$.ajax({url:(0,n.base_url)()+"ajax/aplicar_reserva/",data:a,type:"post"}).done(function(a){var t=m.row(o).data(e).draw(!1).node();$(t).css({backgroundColor:"yellow"}),s.get(),swal("Hechó","¡Reserva aplicada!","success")}).fail(function(e){swal("¡Error!","La operación que intentó realizar ha fallado, contactar al administador sí el error persiste","error")})})})}});