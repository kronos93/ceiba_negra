!function(a){function e(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return a[t].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var t=window.webpackJsonp;window.webpackJsonp=function(e,o,i){for(var r,s,c=0,l=[];c<e.length;c++)s=e[c],n[s]&&l.push(n[s][0]),n[s]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(a[r]=o[r]);for(t&&t(e,o,i);l.length;)l.shift()()};var o={},n={1:0};e.e=function(a){function t(){i.onerror=i.onload=null,clearTimeout(r);var e=n[a];0!==e&&(e&&e[1](new Error("Loading chunk "+a+" failed.")),n[a]=void 0)}if(0===n[a])return Promise.resolve();if(n[a])return n[a][2];var o=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.async=!0,i.timeout=12e4,e.nc&&i.setAttribute("nonce",e.nc),i.src=e.p+""+a+"../bundle.js";var r=setTimeout(t,12e4);i.onerror=i.onload=t;var s=new Promise(function(e,t){n[a]=[e,t]});return n[a][2]=s,o.appendChild(i),s},e.m=a,e.c=o,e.i=function(a){return a},e.d=function(a,t,o){e.o(a,t)||Object.defineProperty(a,t,{configurable:!1,enumerable:!0,get:o})},e.n=function(a){var t=a&&a.__esModule?function(){return a.default}:function(){return a};return e.d(t,"a",t),t},e.o=function(a,e){return Object.prototype.hasOwnProperty.call(a,e)},e.p="",e.oe=function(a){throw console.error(a),a},e(e.s=8)}([function(a,e,t){"use strict";function o(a){return function(){var e=a.apply(this,arguments);return new Promise(function(a,t){function o(n,i){try{var r=e[n](i),s=r.value}catch(a){return void t(a)}if(!r.done)return Promise.resolve(s).then(function(a){o("next",a)},function(a){o("throw",a)});a(s)}return o("next")})}}function n(a){console.log("Dar formato de moneda y superficie"),s()(".superficie").length&&s()(".superficie").autoNumeric(a,{aSign:" m²",pSign:"s"}),s()(".currency").autoNumeric(a,{aSign:"$"})}function i(a){s()("#shopCartSale").find("span").attr("data-venta",a.count);var e=document.getElementById("template-venta").innerHTML,o=Mustache.render(e,a);if(document.getElementById("listaVenta").innerHTML=o,n("init"),s()("#precio").length&&s()("#enganche").length&&s()("#abono").length){n("init"),s()("#precio").autoNumeric("set",a.total),s()("#enganche").autoNumeric("set",a.enganche),s()("#abono").autoNumeric("set",a.abono);var r=10;s()("#porcentaje_comision").val(r),s()("#comision").autoNumeric("set",r/100*s()("#precio").autoNumeric("get"))}if(!a.count){var l=window.location.pathname,d=l.split("/");"venta"==d[d.length-1]&&(window.location.href=t.i(c.base_url)())}s()(".itemCartDelete").on("click",function(a){s.a.ajax({url:t.i(c.base_url)()+"ajax/delete_cart/",data:{rowid:s()(this).val()},type:"post"}).done(function(a){n("init"),i(a)}).fail(function(a){})})}Object.defineProperty(e,"__esModule",{value:!0});var r=t(7),s=t.n(r),c=t(6),l=(t.n(c),t(1));t.n(l);(function(){var a=o(regeneratorRuntime.mark(function a(){var e;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.e(0).then(t.bind(null,9));case 2:return e=a.sent,a.abrupt("return",e().format("LLLL"));case 4:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}})()().then(function(a){return console.log(a)}),moment.locale("es");var d={hidden:function(){s()(".container-icons").find(".message").text().length>0&&(s()(".container-icons").slideUp(0),s()(".container-icons").find(".message").text("")),this.clean_box()},show_error:function(a){this.clean_box(),s()(".container-icons").addClass("container-icons showicon error").find("i").addClass("fa-times-circle-o");var e="Mensaje de error: "+a.responseText;e+="\nVerificar los datos ingresados con los registros existentes.",e+="\nCódigo de error: "+a.status+".",e+="\nMensaje de código error: "+a.statusText+".",this.set_msg(e),s()("input[type='submit']").attr("disabled",!1).next().css("visibility","hidden")},show_success:function(a){this.clean_box(),s()(".container-icons").addClass("container-icons showicon ok").find("i").addClass("fa-check-circle-o"),this.set_msg(a),s()("input[type='submit']").attr("disabled",!1).next().css("visibility","hidden")},clean_box:function(){s()(".container-icons").hasClass("showicon ok")?s()(".container-icons").removeClass("showicon ok").find("i").removeClass("fa-check-circle-o"):s()(".container-icons").hasClass("showicon error")&&s()(".container-icons").removeClass("showicon error").find("i").removeClass("fa-times-circle-o")},set_msg:function(a){s()(".container-icons").slideUp(0),s()(".container-icons").find(".message").empty().html(a),s()(".container-icons").slideDown(625)}},u=function(a){this.data={},this.urls=a.urls,this.url="",this.msgs=a.msgs,this.msg="",this.frm=s()(a.frm),this.btn=a.btn,this.append=a.append,void 0!==a.readonly&&(this.readonly=a.readonly),this.dtTable=a.dtTable,this.autoNumeric=a.autoNumeric,this.dtRow=this.btn.closest("tr").hasClass("parent")||this.btn.closest("tr").hasClass("child")?this.btn.closest("tr").prev("tr.parent"):this.btn.parents("tr"),this.parseDtRow=this.dtTable.row(this.dtRow).data(),console.log(this.parseDtRow),this.response,this.fnOnDone,this.on_submit()};u.prototype.add=function(){this.frm[0].reset(),this.data={},void 0!==this.readonly&&(this.readonly.status=!1,this.fnReadonly()),this.url=this.urls.add,this.msg=this.msgs.add,this.fnOnDone=this.ajaxAddDone},u.prototype.edit=function(){this.data={},void 0!==this.readonly&&(this.readonly.status=!0,this.fnReadonly()),this.url=this.urls.edit,this.msg=this.msgs.edit,this.fnOnDone=this.ajaxEditDone;for(var a in this.parseDtRow)if(s()("#"+a).length){var e=s()("#"+a);e.hasClass("autoNumeric")?e.autoNumeric("set",this.parseDtRow[a]):e.val(this.parseDtRow[a])}for(var a in this.append)this.data[this.append[a]]=this.parseDtRow[this.append[a]]},u.prototype.fnReadonly=function(){s()(this.readonly.inputs).attr("readonly",this.readonly.status)},u.prototype.submit=function(){var a=this;s.a.ajax({url:t.i(c.base_url)()+a.url,type:"post",data:a.data,beforeSend:function(a){s()("input[type='submit']").next().css("visibility","visible")}}).done(function(e){a.response=e,a.fnOnDone.apply(a)}).fail(function(a){d.show_error(a)})},u.prototype.ajaxAddDone=function(){this.frm[0].reset(),console.log(this.response);var a=this.dtTable.row.add(this.response[0]).draw(!1).node();s()(a).animate({backgroundColor:"yellow"}),this.dtTable.order([0,"desc"]).draw(),d.show_success(this.msg)},u.prototype.ajaxEditDone=function(){console.log(this.response[0]);for(var a in this.response[0])this.parseDtRow[a]=this.response[0][a];var e=this.dtTable.row(this.dtRow).data(this.parseDtRow).draw(!1).node();s()(e).animate({backgroundColor:"yellow"}),d.show_success(this.msg)},u.prototype.on_submit=function(){var a=this;this.frm.off("submit").on("submit",function(e){e.preventDefault(),Object.assign(a.data,s()(this).serializeObject());for(data in a.autoNumeric)s()("#"+a.autoNumeric[data]).length>0&&(a.data[a.autoNumeric[data]]=s()("#"+a.autoNumeric[data]).autoNumeric("get"));a.submit()})},s()(document).ready(function(){function a(){for(var a=s()(".multiplicar"),e=1,t=0;t<a.length;t++)e*=s()(a[t]).autoNumeric("get");s()("#precio").autoNumeric("set",e)}s.a.get(t.i(c.base_url)()+"ajax/add_cart",function(a){i(a)}),s()("#shopCartSale").on("click",function(a){s()(this).find(".my-dropdown").slideToggle("3500")}),s()("#shopCartSale").find("nav").on("click",function(a){a.stopPropagation()}),s()(document).mouseup(function(a){var e=s()(".my-dropdown");e.is(a.target)||0!==e.has(a.target).length||e.hide()}),tinymce.init({selector:"#contrato_html",mode:"specifics_textareas",editor_selector:"mceEditor",height:"600px",plugins:["advlist autolink lists charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code fullscreen","nonbreaking save table directionality","template paste textcolor colorpicker textpattern"],toolbar1:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image",content_css:t.i(c.base_url)()+"/assets/css/tinymce.css",setup:function(a){a.on("init",function(a){})},init_instance_callback:function(a){a.on("SetContent",function(a){console.log("Asignando contenido dinamico");var e=["fecha_primer_pago","fecha_ultimo_pago","fecha_init_1","fecha_init_2","fecha_init_3","fecha_init_4","fecha_init_5"];for(var t in e){var o=this.dom.get(e[t]),n=s()(o).html(),i=moment(n,"DD-MM-YYYY");this.dom.setHTML(o,i.format("[el día ] dddd, DD [de] MMMM [del] [año] YYYY"))}var r=["precio_1","precio_2","enganche","abono_1","abono_2","porcentaje"];for(var c in r){var l=this.dom.get(r[c]),d=s()(l).html();if("porcentaje"==r[c])var u=NumeroALetras(d).replace(/\b00\/100 MN\b/,"").replace(/\bPeso\b/,"").replace(/\bCON\b/g,"PUNTO").replace(/\bPESOS\b/g,"").replace(/\bCENTAVOS\b/g,"").replace(/\s{2,}/g," ");else var u=NumeroALetras(d).replace(/\s{2,}/g," ");this.dom.setHTML(l,u)}})}});var e=s()("#frm-venta");e.validate({errorPlacement:function(a,e){e.before(a)},lang:"es"}),e.steps({headerTag:"h3",bodyTag:"div",transitionEffect:"slide",autoFocus:!0,onInit:function(){s()("#fecha_init").mask("00-00-0000"),s()("#fecha_init").datepicker({dateFormat:"dd-mm-yy"}),s()("#fecha_nacimiento").mask("00-00-0000"),s()("#fecha_nacimiento").datepicker({dateFormat:"dd-mm-yy"}),s()("#clientes_autocomplete").autocomplete({serviceUrl:t.i(c.base_url)()+"ajax/autocomplete_clientes",noCache:!0,autoSelectFirst:!0,onSelect:function(a){console.log(a);var e={first_name:"Default",last_name:"Default Default",email:"default@huertoslaceiba.com",phone:"99821234567",calle:"Default",no_ext:"100",no_int:"100",colonia:"Default",municipio:"Default",estado:"Default",ciudad:"Default",cp:"77777",lugar_nacimiento:"Default",fecha_nacimiento:"01-01-1999"},t={ciudad_expedicion:"Playa del Carmen",testigo_1:"XXXX XXXX XXXX",testigo_2:"XXXX XXXX XXXX"};for(var o in a)""!=a[o]&&null!=a[o]&&0!=a[o]||(a[o]=e[o]),s()("#"+o).val(a[o]);for(var o in t)s()("#"+o).val(t[o]);s()("#id_cliente").val(a.id_cliente)},onSearchError:function(a,e,t,o){console.log("Ha ocurrido un error xhr.")},onInvalidateSelection:function(){console.log("Ha ocurrido un error en la selección.");var a={first_name:"Default",last_name:"Default Default",email:"default@huertoslaceiba.com",phone:"99821234567",calle:"Default",no_ext:"100",no_int:"100",colonia:"Default",municipio:"Default",estado:"Default",ciudad:"Default",cp:"77777s",lugar_nacimiento:"Default",fecha_nacimiento:"01-01-1999"},e={ciudad_expedicion:"Playa del Carmen",testigo_1:"XXXX XXXX XXXX",testigo_2:"XXXX XXXX XXXX"};for(var t in a)s()("#"+t).val("");for(var t in e)s()("#"+t).val("");s()("#id_cliente").val("")}}),s()("#lideres_autocomplete").autocomplete({serviceUrl:t.i(c.base_url)()+"ajax/autocomplete_lideres",noCache:!0,autoSelectFirst:!0,onSelect:function(a){s()("#id_lider").val(a.id)},onSearchError:function(a,e,t,o){console.log("Ha ocurrido un error.")}}),s()("#precio").on("change keyup",function(){var a=parseFloat(s()(this).autoNumeric("get")),e=parseFloat(s()("#porcentaje_comision").val()),t=parseFloat(s()("#enganche").autoNumeric("get"));s()("#comision").autoNumeric("set",e/100*a),a==t?(console.log("iguales"),s()(".select-periodos").slideUp(300),s()("#abono").autoNumeric("set",0)):a<t?(console.log("menor"),s()("#enganche").autoNumeric("set",a),s()("#abono").autoNumeric("set",0),s()(".select-periodos").slideUp(300)):(console.log("default"),s()(".select-periodos").slideDown(300))}),s()("#enganche").on("change keyup",function(){var a=parseFloat(s()("#precio").autoNumeric("get")),e=parseFloat(s()(this).autoNumeric("get"));e===a?(s()(".select-periodos").slideUp(300),s()("#abono").autoNumeric("set",0)):e>a?(s()(this).autoNumeric("set",a),s()(".select-periodos").slideUp(300),s()("#abono").autoNumeric("set",0)):s()(".select-periodos").slideDown(300)}),s()("#porcentaje_comision").on("change keyup",function(){var a=this.value,e=s()("#precio").autoNumeric("get");s()("#comision").autoNumeric("set",a/100*e)}),s()("#comision").on("change keyup",function(){var a=s()(this).autoNumeric("get"),e=s()("#precio").autoNumeric("get");s()("#porcentaje_comision").val((a/e*100).toFixed(2))}),s()("#tipo_historial").on("change",function(){var a=s()(this).val();"ini-mes"==a||"quincena-mes"==a||"1-15"==a?s()("#empezar_pago").show():s()("#empezar_pago").hide()})},onStepChanging:function(a,o,n){if(2==n){tinymce.activeEditor.setContent("");var i={first_name:"",last_name:"",email:"",phone:"",lugar_nacimiento:"",fecha_nacimiento:"",calle:"",no_ext:"",no_int:"",colonia:"",municipio:"",estado:"",ciudad:"",cp:"",testigo_1:"",testigo_2:"",ciudad_expedicion:"",tipo_historial:"",confirmyes:"",confirmno:"",id_lider:"",fecha_init:"",precio:0,enganche:0,abono:0,porcentaje_penalizacion:0,maximo_retrasos_permitidos:0},r=s()("#tipo_historial").val();if(console.log(r),"1-15"==r||"quincena-mes"==r||"fin-mes"==r){console.log(r);var l=s()("#n_pago").val();i.n_pago=l}for(var d in i){var u=s()("#"+d);u.hasClass("currency")?i[d]=u.autoNumeric("get"):i[d]=u.val()}s.a.ajax({data:i,url:t.i(c.base_url)()+"venta/generar_contrato/",async:!0,type:"post",beforeSend:function(){tinymce.activeEditor.setContent("")}}).done(function(a){tinymce.activeEditor.selection.setContent(a.html)}).fail(function(a){sweetAlert("¡Error!","Algo salió mal, contactar al administrador.","error")})}return e.validate().settings.ignore=":disabled,:hidden",e.valid()},onFinishing:function(a,t){return e.validate().settings.ignore=":disabled",e.valid()},onFinished:function(a,e){var o=s()(this).serializeObject();o.contrato_html=tinymce.activeEditor.getContent(),o.precio=s()("#precio").autoNumeric("get"),o.enganche=s()("#enganche").autoNumeric("get"),o.abono=s()("#abono").autoNumeric("get"),swal({title:"¿Desea guardar los datos?",text:"Generar contrato",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0},function(){s.a.ajax({data:o,url:t.i(c.base_url)()+"venta/guardar_contrato/",async:!0,type:"post",beforeSend:function(){},success:function(a){}}).done(function(a){swal("¡Contrato generado exitosamente!"),window.location.href=t.i(c.base_url)()+"venta/historial_de_ventas"}).fail(function(a){sweetAlert("¡Error!","Algo salió mal, contactar al administrador.","error")})}),console.log(o)},labels:{cancel:"Cancelar",current:"Paso Actual:",pagination:"Pagination",finish:"Finalizar",next:"Siguiente",previous:"Anterior",loading:"Cargando ..."}});var o=s()("#manzanas-table").DataTable({ajax:t.i(c.base_url)()+"ajax/get_manzanas",columns:[{data:"id_manzana",type:"num"},{data:"manzana",render:function(a,e,t,o){return"<span class='mz'>"+a+"</span>"},type:"html-num"},{data:"calle"},{data:"superficie",render:function(a,e,t,o){return'<span class="superficie">'+a+"</span>"}},{data:"disponibilidad",render:function(a,e,t,o){return parseInt(a)?'<span class="label label-success">Disponible</span>':'<span class="label label-primary">No disponible</span>'}},{data:"col_norte"},{data:"col_noreste"},{data:"col_este"},{data:"col_sureste"},{data:"col_sur"},{data:"col_suroeste"},{data:"col_oeste"},{data:"col_noroeste"},{data:""}],columnDefs:[{targets:-1,data:null,defaultContent:'<button data-toggle="modal" data-target="#manzanaModal" data-title="Editar manzana" data-btn-type="edit" class="btn btn-info btn-sm"><i class="fa fa-fw fa-pencil"></i></button>'},{sortable:!1,targets:[-1,-2,-3,-4,-5,-6,-7,-8,-9,-12]},{searchable:!1,targets:[-1]}],order:[[1,"asc"]],drawCallback:function(a){n("init")}});o.on("responsive-display",function(a,e,t,o,i){n("init")}),s()("#manzanaModal").on("show.bs.modal",function(a){d.hidden();var e=s()(a.relatedTarget),t=e.data("title"),n=e.data("btnType");console.log(e),s()(this).find(".model-title").html(t),new u({frm:"#frm-manzana",urls:{edit:"ajax/update_manzana",add:"ajax/add_manzana"},msgs:{edit:"Manzana actualizada correctamente.",add:"Manzana agregada correctamente."},autoNumeric:["superficie"],readonly:{inputs:"#manzana"},append:["id_manzana"],btn:e,dtTable:o})[n]()}),s()(".multiplicar").on("keyup",a);var r=s()("#huertos-table").DataTable({ajax:t.i(c.base_url)()+"ajax/get_huertos_pmz",columns:[{data:"id_huerto",type:"num"},{data:"manzana",render:function(a,e,t,o){return'<span class="mz">'+a+"</span>"},type:"html-num"},{data:"huerto",render:function(a,e,t,o){return'<span class="ht">'+a+"</span>"},type:"html-num"},{data:"superficie",render:function(a,e,t,o){return'<span class="superficie">'+a+"</span>"}},{data:"precio_x_m2",render:function(a,e,t,o){return'<span class="currency">'+a+"</span>"}},{data:"precio",render:function(a,e,t,o){return'<span class="currency">'+a+"</span>"}},{data:"enganche",render:function(a,e,t,o){return'<span class="currency">'+a+"</span>"}},{data:"abono",render:function(a,e,t,o){return'<span class="currency">'+a+"</span>"}},{data:"vendido",render:function(a,e,t,o){return parseInt(a)?'<span class="label label-success">Vendido</span>':'<span class="label label-primary">No vendido</span>'}},{data:"col_norte"},{data:"col_noreste"},{data:"col_este"},{data:"col_sureste"},{data:"col_sur"},{data:"col_suroeste"},{data:"col_oeste"},{data:"col_noroeste"},{data:""}],columnDefs:[{targets:-1,data:null,defaultContent:'<button data-toggle="modal" data-title="Editar huerto" data-btn-type="edit" data-target="#huertoModal" class="btn btn-info btn-sm"><i class="fa fa-fw fa-pencil"></i></button>'},{sortable:!1,targets:[-1,-2,-3,-4,-5,-6,-7,-8,-9]},{targets:[-1,-2,-3,-4,-5],searchable:!1}],order:[[1,"asc"]],drawCallback:function(a){n("init")}});r.on("responsive-display",function(a,e,t,o,i){n("init")}),s()("#huertoModal").on("show.bs.modal",function(a){d.hidden();var e=s()(a.relatedTarget),t=e.data("title"),o=e.data("btnType");s()(this).find(".model-title").html(t),new u({frm:"#frm-huerto",urls:{edit:"ajax/update_huerto",add:"ajax/add_huerto"},msgs:{edit:"Huerto actualizado correctamente.",add:"Huerto agregado correctamente."},autoNumeric:["superficie","precio_x_m2","precio"],append:["id_huerto"],btn:e,dtTable:r})[o]()});var l=s()("#opciones-de-ingreso-table").DataTable({ajax:t.i(c.base_url)()+"ajax/get_opciones_de_ingreso",columns:[{data:"id_opcion_ingreso"},{data:"nombre"},{data:"cuenta",render:function(a,e,t,o){return 0===parseInt(a)?"":a}},{data:"tarjeta",render:function(a,e,t,o){return 0===parseInt(a)?"":a}},{data:"ingreso",render:s.a.fn.dataTable.render.number(",",".",2,"$"),type:"num-fmt"},{data:"",render:function(a,e,t,o){var n='<a href="ingresos/'+t.id_opcion_ingreso+'" class="btn btn-info btn-sm"><i class="fa fa-fw fa-search"></i>Ver ingresos<a/>';return 1===t.id_opcion_ingreso||"CAJA"===t.nombre?n:'<button data-toggle="modal" data-title="Editar opción de ingreso" data-btn-type="edit" data-target="#opcionDeIngresoModal" class="btn btn-info btn-sm"><i class="fa fa-fw fa-pencil"></i></button> '+n}}],columnDefs:[{sortable:!1,targets:[1,5]}]});s()("#opcionDeIngresoModal").on("show.bs.modal",function(a){d.hidden();var e=s()(a.relatedTarget),t=e.data("title"),o=e.data("btnType");s()(this).find(".model-title").html(t),new u({frm:"#frm-opcion-ingreso",urls:{edit:"ajax/update_opcion_ingreso",add:"ajax/add_opcion_ingreso"},msgs:{edit:"Opción de ingreso actualizada correctamente.",add:"Opción de ingreso agregada correctamente."},autoNumeric:[],append:["id_opcion_ingreso"],btn:e,dtTable:l})[o]()});var p=s()("#users-table").DataTable({columns:[{data:"first_name"},{data:"last_name"},{data:"email"},{data:"groups"},{data:"btn_activar_desactivar"},{data:"btn_editar"}],columnDefs:[{sortable:!1,targets:[1,2,3,4,5]},{targets:[],searchable:!1}],order:[[0,"asc"]]});s()("#userModal").on("shown.bs.modal",function(a){console.log(s()("#frm-ion-user")),d.hidden();var e=s()(a.relatedTarget),t=e.data("btnType"),o={frm:"#frm-ion-user",urls:{edit:"ajax/update_ion_user",add:"ajax/add_ion_user"},msgs:{edit:"Usuario actualizado correctamente.",add:"Usuario agregado correctamente."},btn:e,dtTable:p},n=new u(o);t&&(n.edit=function(){console.log("Haz nada"),this.url=this.urls.edit,this.msg=this.msgs.edit,this.fnOnDone=this.ajaxEditDone},n[t]())}).on("hidden.bs.modal",function(){s()(this).removeData("bs.modal")});var m=s()("#historial-ventas-table").DataTable({responsive:{details:{display:s.a.fn.dataTable.Responsive.display.childRowImmediate}},columns:[{data:"id_venta"},{data:"nombre_cliente"},{data:"retraso"},{data:"retrasados"},{data:"adelantados"},{data:"en_tiempo"},{data:"realizados"},{data:"descripcion"},{data:"precio"},{data:"comision"},{data:"abonado"},{data:"comisiones"},{data:"nombre_lider"},{data:"nombre_user"},{data:""}],columnDefs:[{targets:[],searchable:!1}],order:[[1,"asc"]]});s()("#historial-ventas-table").on("click",".cancelar-venta",function(){h=s()(this).closest("tr").hasClass("parent")||s()(this).closest("tr").hasClass("child")?s()(this).closest("tr").prev("tr.parent"):s()(this).parents("tr");var a=m.row(h).data(),e={id_venta:a.id_venta};swal({title:"Cancelar venta",text:"Esta a punto de cancelar una venta, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){s.a.ajax({url:t.i(c.base_url)()+"ajax/cancelar_venta/",data:e,type:"post"}).done(function(a){swal("¡Pago removido!")}).fail(function(a){})})}),s()("#historial-ventas-table").on("click",".activar-venta",function(){h=s()(this).closest("tr").hasClass("parent")||s()(this).closest("tr").hasClass("child")?s()(this).closest("tr").prev("tr.parent"):s()(this).parents("tr");var a=m.row(h).data(),e={id_venta:a.id_venta};swal({title:"Cancelar venta",text:"Esta a punto de cancelar una venta, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){s.a.ajax({url:t.i(c.base_url)()+"ajax/activar_venta/",data:e,type:"post"}).done(function(a){swal("¡Pago removido!")}).fail(function(a){})})}),s()("#historial-ventas-table").on("click",".eliminar-venta",function(){h=s()(this).closest("tr").hasClass("parent")||s()(this).closest("tr").hasClass("child")?s()(this).closest("tr").prev("tr.parent"):s()(this).parents("tr");var a=m.row(h).data(),e={id_venta:a.id_venta};swal({title:"Cancelar venta",text:"Esta a punto de cancelar una venta, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){s.a.ajax({url:t.i(c.base_url)()+"ajax/eliminar_venta/",data:e,type:"post"}).done(function(a){swal("¡Pago removido!")}).fail(function(a){})})}),s()("#historial-ventas-table").on("click",".recuperar-venta",function(){h=this.btn.closest("tr").hasClass("parent")||this.btn.closest("tr").hasClass("child")?this.btn.closest("tr").prev("tr.parent"):this.btn.parents("tr");var a=m.row(h).data(),e={id_venta:a.id_venta};swal({title:"Cancelar venta",text:"Esta a punto de cancelar una venta, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){s.a.ajax({url:t.i(c.base_url)()+"ajax/recuperar_venta/",data:e,type:"post"}).done(function(a){swal("¡Pago removido!")}).fail(function(a){})})});var f=s()("#pagos-table").DataTable({responsive:{details:{display:s.a.fn.dataTable.Responsive.display.childRowImmediate}},columns:[{data:"id_historial"},{data:"nombre_cliente"},{data:"nombre_lider"},{data:"concepto"},{data:"abono"},{data:"fecha"},{data:"estado"},{data:"detalles"},{data:"",render:function(a,e,t,o){return void 0==t.pago||parseFloat(t.pago)?void 0!=t.pago&&parseFloat(t.pago)>0?void 0==t.comision||parseFloat(t.comision)?t.is_admin?'<button class="btn btn-danger removerPago">Remover pago</button> ':"":t.is_admin?'<button class="btn btn-danger removerPago">Remover pago</button> <button class="btn btn-warning" data-toggle="modal" data-target="#pagoComisionModal">Registrar comisión</button>':'<button class="btn btn-warning" data-toggle="modal" data-target="#pagoComisionModal">Registrar comisión</button>':a:'<button class="btn btn-success" data-toggle="modal" data-target="#pagoModal">Registrar pago</button> '}}],columnDefs:[{targets:-1,data:null,defaultContent:""},{sortable:!1,targets:[1,2,3,4,5,6,7]},{targets:0,type:"num"}],order:[[0,"asc"]]});s()("#fecha_pago").mask("00-00-0000"),s()("#fecha_pago").datepicker({dateFormat:"dd-mm-yy"}).datepicker("setDate",new Date);var h,g=0;s()("#pagoModal").on("shown.bs.modal",function(a){var e=s()(a.relatedTarget);h=s()(e).parents("tr"),g=f.row(h).data().id_historial,s.a.ajax({url:t.i(c.base_url)()+"ajax/get_pagos/",data:{id_historial:g},type:"post"}).done(function(a){s()("#pago").autoNumeric("set",a.abono),s()("#id_lider").val(a.id_lider),s()("#comision").autoNumeric("set",a.comision),s()("#porcentaje_comision").val(a.porcentaje_comision),s()("#penalizacion").autoNumeric("set",a.penalizacion),s()("#porcentaje_penalizacion").val(a.porcentaje_penalizacion),s()("#daysAccumulated").val(a.daysAccumulated)}).fail(function(a){})}),s()("#frm-pago #porcentaje_comision").on("change keyup",function(){var a=s()(this).val(),e=s()("#frm-pago #pago").autoNumeric("get");s()("#frm-pago #comision").autoNumeric("set",e*(a/100))}),s()("#frm-pago #comision").on("keyup",function(){var a=s()(this).autoNumeric("get"),e=s()("#frm-pago #pago").autoNumeric("get");s()("#frm-pago #porcentaje_comision").val((a/e*100).toFixed(2))}),s()("#frm-pago #porcentaje_penalizacion").on("change keyup",function(){var a=s()(this).val(),e=s()("#frm-pago #pago").autoNumeric("get"),t=s()("#daysAccumulated").val();s()("#frm-pago #penalizacion").autoNumeric("set",e*(a/100)*t)}),s()("#frm-pago #penalizacion").on("change keyup",function(){var a=s()("#penalizacion").autoNumeric("get"),e=s()("#frm-pago #pago").autoNumeric("get"),t=s()("#daysAccumulated").val();s()("#frm-pago #porcentaje_penalizacion").val((a/(e*t)*100).toFixed(2))}),s()("#frm-pago").on("submit",function(a){a.preventDefault();var e=s()(this).serializeObject();e.id_historial=g,e.pago=s()("#pago").autoNumeric("get"),e.penalizacion=s()("#penalizacion").autoNumeric("get"),e.comision=s()("#comision").autoNumeric("get"),s.a.ajax({url:t.i(c.base_url)()+"ajax/pagar/",data:e,type:"post"}).done(function(a){s()("#pagoModal").modal("hide");var e=f.row(h).data(a).draw(!1).node();s()(e).animate({backgroundColor:"yellow"})}).fail(function(a){})}),s()("#pagoComisionModal").on("shown.bs.modal",function(a){var e=s()(a.relatedTarget);h=s()(e).parents("tr"),g=f.row(h).data().id_historial,s.a.ajax({url:t.i(c.base_url)()+"ajax/get_comision/",data:{id_historial:g},type:"post"}).done(function(a){s()("#pago2").autoNumeric("set",a.abono),s()("#id_lider2").val(a.id_lider),s()("#comision2").autoNumeric("set",a.comision),s()("#porcentaje_comision2").val(a.porcentaje_comision)}).fail(function(a){})}),s()("#porcentaje_comision2").on("change keyup",function(){var a=s()(this).val(),e=s()("#pago2").autoNumeric("get");s()("#comision2").autoNumeric("set",e*(a/100))}),s()("#frm-pago-comision").on("submit",function(a){a.preventDefault();var e=s()(this).serializeObject();e.id_historial=g,e.pago=s()("#pago2").autoNumeric("get"),e.comision=s()("#comision2").autoNumeric("get"),s.a.ajax({url:t.i(c.base_url)()+"ajax/pagar_comision/",data:e,type:"post"}).done(function(a){s()("#pagoComisionModal").modal("hide");var e=f.row(h).data(a).draw(!1).node();s()(e).animate({backgroundColor:"yellow"})}).fail(function(a){})}),s()("#pagos-table").on("click",".removerPago",function(){h=s()(this).parents("tr");var a=f.row(h).data(),e={id_historial:a.id_historial};swal({title:"Remover pago",text:"Esta a punto de remover un pago, ¿Desea continuar?",type:"info",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,cancelButtonText:"CANCELAR"},function(){s.a.ajax({url:t.i(c.base_url)()+"ajax/remover_pago/",data:e,type:"post"}).done(function(a){var e=f.row(h).data(a).draw(!1).node();s()(e).animate({backgroundColor:"yellow"}),swal("¡Pago removido!")}).fail(function(a){})})}),s()("#init_date").mask("00-00-0000"),s()("#init_date").datepicker({dateFormat:"dd-mm-yy"}),s()("#end_date").mask("00-00-0000"),s()("#end_date").datepicker({dateFormat:"dd-mm-yy"}),s()("[data-toggle=popover]").on("click",function(a){console.log(a);var e=a;s()("[data-toggle=popover]").popover("hide"),s()(this).popover({html:!0}).popover("show").on("shown.bs.popover",function(){e.stopPropagation(),s()(".popover").attr("tabindex","10").on("click",function(a){a.stopPropagation()})}).on("hidden.bs.popover",function(){e.stopPropagation()}),e.stopPropagation()})}),console.log("hola")},function(a,e,t){t(2),t(5),t(4),t(3)},function(a,e){$.extend(!0,$.fn.dataTable.defaults,{pagingType:"full_numbers",language:{url:"https://cdn.datatables.net/plug-ins/1.10.12/i18n/Spanish.json",decimal:".",thousands:","},responsive:!0,deferRender:!0,pageLength:25})},function(a,e){$.datepicker.setDefaults($.datepicker.regional.es)},function(a,e){$.fn.serializeObject=function(){var a={},e=this.serializeArray();return $.each(e,function(){void 0!==a[this.name]?(a[this.name].push||(a[this.name]=[a[this.name]]),a[this.name].push(this.value||"")):a[this.name]=this.value||""}),a}},function(a,e){jQuery.extend(jQuery.validator.messages,{required:"Este campo es obligatorio.",remote:"Por favor, rellena este campo.",email:"Por favor, escribe una dirección de correo válida",url:"Por favor, escribe una URL válida.",date:"Por favor, escribe una fecha válida.",dateISO:"Por favor, escribe una fecha (ISO) válida.",number:"Por favor, escribe un número entero válido.",digits:"Por favor, escribe sólo dígitos.",creditcard:"Por favor, escribe un número de tarjeta válido.",equalTo:"Por favor, escribe el mismo valor de nuevo.",accept:"Por favor, escribe un valor con una extensión aceptada.",maxlength:jQuery.validator.format("Por favor, no escribas más de {0} caracteres."),minlength:jQuery.validator.format("Por favor, no escribas menos de {0} caracteres."),rangelength:jQuery.validator.format("Por favor, escribe un valor entre {0} y {1} caracteres."),range:jQuery.validator.format("Por favor, escribe un valor entre {0} y {1}."),max:jQuery.validator.format("Por favor, escribe un valor menor o igual a {0}."),min:jQuery.validator.format("Por favor, escribe un valor mayor o igual a {0}.")})},function(a,e,t){a.exports={base_url:function(){return"http://"+window.location.hostname+"/ceiba_negra/"}}},function(a,e){a.exports=jQuery},function(a,e,t){a.exports=t(0)}]);